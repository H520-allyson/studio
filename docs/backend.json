{
  "entities": {
    "Order": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Order",
      "type": "object",
      "description": "Represents a customer order for printing services.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the order."
        },
        "clientName": {
          "type": "string",
          "description": "The full name of the client who placed the order."
        },
        "clientEmail": {
          "type": "string",
          "description": "The email address of the client.",
          "format": "email"
        },
        "notes": {
          "type": "string",
          "description": "Detailed printing requirements and instructions from the client."
        },
        "fileUrl": {
          "type": "string",
          "description": "URL of the uploaded print file in Firebase Storage.",
          "format": "uri"
        },
        "orderStatus": {
          "type": "string",
          "description": "The current status of the order (e.g., Received, In Review, Printing, Ready for Pickup!)."
        },
        "orderDate": {
          "type": "string",
          "description": "The date and time when the order was placed.",
          "format": "date-time"
        },
        "orderReferenceNumber": {
          "type": "string",
          "description": "A unique reference number for the order."
        }
      },
      "required": [
        "id",
        "clientName",
        "clientEmail",
        "notes",
        "fileUrl",
        "orderStatus",
        "orderDate",
        "orderReferenceNumber"
      ]
    },
    "ShopConfiguration": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ShopConfiguration",
      "type": "object",
      "description": "Represents customizable settings for the printing shop.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the shop configuration."
        },
        "shopName": {
          "type": "string",
          "description": "The name of the printing shop."
        },
        "logoUrl": {
          "type": "string",
          "description": "URL of the shop's logo image.",
          "format": "uri"
        },
        "currency": {
          "type": "string",
          "description": "The currency used by the shop (e.g., PHP for Philippine Peso)."
        },
        "businessHours": {
          "type": "string",
          "description": "Shop business hours in a textual format (e.g., 'Mon-Fri: 9am-6pm, Sat: 10am-2pm')."
        },
        "aboutUsText": {
          "type": "string",
          "description": "The 'About Us' text displayed on the landing page."
        },
        "contactInformation": {
          "type": "string",
          "description": "The shop's contact information (e.g., address, phone number)."
        },
        "defaultPricingFormula": {
          "type": "string",
          "description": "Default formula used for price calculation in cost calculator."
        }
      },
      "required": [
        "id",
        "shopName",
        "currency",
        "businessHours",
        "aboutUsText",
        "contactInformation"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/shop_configuration/{shopConfigurationId}",
        "definition": {
          "entityName": "ShopConfiguration",
          "schema": {
            "$ref": "#/backend/entities/ShopConfiguration"
          },
          "description": "Stores customizable shop settings. Only accessible and editable by admins.",
          "params": [
            {
              "name": "shopConfigurationId",
              "description": "Unique identifier for the shop configuration document."
            }
          ]
        }
      },
      {
        "path": "/orders/{orderReferenceNumber}",
        "definition": {
          "entityName": "Order",
          "schema": {
            "$ref": "#/backend/entities/Order"
          },
          "description": "Stores order details. Accessible only by authenticated admins.",
          "params": [
            {
              "name": "orderReferenceNumber",
              "description": "Unique order reference number, serves as the document ID."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{userId}",
        "definition": {
          "entityName": "role_admin",
          "schema": {
            "$ref": "#/backend/entities/Order"
          },
          "description": "Collection to store admin roles. Existence of a document with the user's UID grants admin privileges.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase UID of the user with admin privileges."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore data structure is designed to support the Print Genie application, focusing on a secure and manageable admin panel for shop configuration and order management. The structure emphasizes authorization independence to ensure secure operations without complex rule dependencies.\n\n*   **Shop Configuration:** The `shop_configuration` collection stores customizable shop settings. Since only admins should modify this data, a dedicated `roles_admin` collection is used to manage admin privileges. Security rules will check for the existence of a document with the user's UID in this collection.\n*   **Orders:** The `orders` collection stores order details. Access is restricted to authenticated users (admins) who are part of `roles_admin`.  The `orderReferenceNumber` is used as the document ID for easy lookup and status tracking.\n\nThis design ensures that all documents in each collection share the same security posture, simplifying the security rules and enhancing debuggability.  Authorization Independence is achieved by relying solely on the `request.auth.uid` and the existence of an admin role, avoiding `get()` calls in security rules. The QAP requirements are met by restricting access to the `orders` and `shop_configuration` collections based on admin role."
  }
}